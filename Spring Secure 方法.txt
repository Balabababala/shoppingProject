



Authentication authentication = authenticationManager.authenticate(
    new UsernamePasswordAuthenticationToken(loginDTO.getUsername(), loginDTO.getPassword())
);
ğŸ‘‰ é©—è­‰æˆåŠŸï¼š

authenticate() æœƒå›å‚³ä¸€å€‹ Authentication ç‰©ä»¶ï¼ˆè£¡é¢å«æœ‰ principal = CustomUserDetailsã€rolesã€credentials å·²æ¸…é™¤ç­‰è³‡è¨Šï¼‰

ä½ å¯ä»¥é€é authentication.getPrincipal() æ‹¿åˆ°ä½ è‡ªå®šç¾©çš„ CustomUserDetailsï¼Œå†æ‹¿åˆ° User Entityã€‚

ğŸ‘‰ é©—è­‰å¤±æ•—ï¼ˆé‡é»ï¼ï¼‰ï¼š

authenticate() æœƒä¸Ÿå‡ºä¾‹å¤–ï¼ˆExceptionï¼‰ï¼Œé€šå¸¸æ˜¯ä»¥ä¸‹å¹¾ç¨®ï¼š

BadCredentialsException â†’ å¸³è™Ÿå¯†ç¢¼éŒ¯èª¤

UsernameNotFoundException â†’ æ‰¾ä¸åˆ° usernameï¼ˆé€™åœ¨ä½ çš„ CustomUserDetailsService è£¡æœƒæ‹‹ï¼‰

DisabledException â†’ å¸³è™Ÿè¢«åœç”¨ï¼ˆisEnabled() = falseï¼‰

LockedException â†’ å¸³è™Ÿè¢«é–ä½ï¼ˆisAccountNonLocked() = falseï¼‰

å…¶ä»– â†’ AuthenticationException æ˜¯çµ±ä¸€çš„çˆ¶é¡åˆ¥

ç›´æ¥å–useræ–¹æ³•
CustomUserDetails userDetails = (CustomUserDetails) authentication.getPrincipal();
User user = userDetails.getUser();








æ•™å­¸

1ï¸âƒ£ Authentication ç‰©ä»¶é•·ä»€éº¼æ¨£ï¼Ÿ
ç•¶ä½ åŸ·è¡Œå®Œï¼š


Authentication authentication = authenticationManager.authenticate(...);
â†’ Authentication æ˜¯ä¸€å€‹ä»‹é¢ï¼Œå¸¸è¦‹çš„å¯¦ä½œæ˜¯ UsernamePasswordAuthenticationToken
â†’ è£¡é¢åŒ…å«ï¼š

principal â†’ é€šå¸¸æ˜¯ä½ çš„ CustomUserDetails ç‰©ä»¶

credentials â†’ é€šå¸¸é©—è­‰æˆåŠŸå¾Œæœƒè¨­æˆ nullï¼ˆé¿å…å¯†ç¢¼æ´©æ¼ï¼‰

authorities â†’ ä½¿ç”¨è€…æ¬Šé™ï¼ˆROLE_USER / ROLE_ADMIN ...ï¼‰

isAuthenticated â†’ boolean æ˜¯å¦å·²èªè­‰æˆåŠŸ

